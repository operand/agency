---
title: Agent Implementation
---

# Agent Implementation

To create an agent, extend the `Agent` class.

```python
class MyAgent(Agent):
    ...
```

## Defining Actions

Actions are simply instance methods decorated with `@action`. The `@action`
decorator takes the following keyword arguments:

* `name`: The name of the action. Defaults to the method name
* `help`: The description of the action. Defaults to autogenerated object
* `access_policy`: The access policy of the action. Defaults to `ACCESS_PERMITTED`

The `help` attribute may be used for describing the given action when the `help`
action is called.

Below is an example of the help information automatically generated by default
from the `@action` decorator arguments and the method's signature.

```python
{
  "shell_command": {
    "description": "Execute a shell command",
    "args": {
      "command": {
        "type": "string"
        "description": "The command to execute"
      }
    },
    "returns": {
      "type": "string"
      "description": "The output of the command"
    }
  },
  ...
}
```

The following example shows how the above help information can be defined using
a docstring that follows the [Google style
guide](https://github.com/google/styleguide/blob/gh-pages/pyguide.md#383-functions-and-methods):

```python
@action
def shell_command(self, command: str) -> str:
    """
    Execute a shell command

    Args:
        command (str): The command to execute

    Returns:
        str: The output of the command
    """
```

The action name is determined by the method name.

Types are determined by looking at the docstring and the signature, with the
signature type hint taking precedence.

Action and argument descriptions are parsed from the docstring.


### Overriding Help Information

The default help data structure could be customized as well:

```python
@action(
    help={
      "You": "can define",
      "any": {
        "structure": ["you", "want", "here."]
      }
    }
)
def say(self, content: str) -> None:
```

If a `help` object is provided to the decorator, it overrides the generated
object entirely. You can use this to experiment with different help information
schemas.

Merging the two objects, for example in order to only override specific fields,
is not (yet) supported. Let me know if you'd like to see this feature developed.


## Special Actions

There are three special actions present on all agents by default:

Override or extend these actions to customize the behavior of your agent.

* `help`\
Returns a list of all actions on this agent. This is used by agents for action
discovery. You normally do not need to implement this method but you may do so
for example, to control which actions are returned to other agents.

* `response`\
If an action method returns a value, this method will be called with the value.

* `error`\
Receives any error messages from an action invoked by the agent.


## Callbacks

The following is the list of agent callbacks you may implement.

* `before_action`\
Called before an action is attempted. If an exception is raised in
`before_action`, the action method and `after_action` callbacks will not be
executed and the error will be returned to the sender.

* `after_action`\
Called after an action is attempted. Provides the original message, the return
value, and error if applicable. This method is called even if an exception is
raised in the action.

* `after_add`\
Called after an agent is added to a space and may begin sending/receiving
messages. Use this method to perform any initial setup necessary upon being
added to a space.

* `before_remove`\
Called before an agent is removed from a space and will no longer send/receive
messages. Use this method to perform any cleanup necessary before being removed
from a space.

* `request_permission`\
Called when an agent attempts to perform an action that requires permission.
This method should return `True` or `False` to indicate whether the action
should be allowed. A rejected action will be returned as a permission error to
the sender.
