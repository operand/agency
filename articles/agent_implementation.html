<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-76DYGNV0GJ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-76DYGNV0GJ'); </script> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Agent Implementation | Agency</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Agent Implementation" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Agent Implementation" /> <meta property="og:description" content="Agent Implementation" /> <link rel="canonical" href="https://createwith.agency/articles/agent_implementation" /> <meta property="og:url" content="https://createwith.agency/articles/agent_implementation" /> <meta property="og:site_name" content="Agency" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Agent Implementation" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Agent Implementation","headline":"Agent Implementation","url":"https://createwith.agency/articles/agent_implementation"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Agency </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category">Articles</div> <ul class="nav-list"><li class="nav-list-item"><a href="/articles/walkthrough" class="nav-list-link">Example Application Walkthrough</a></li><li class="nav-list-item active"><a href="/articles/agent_implementation" class="nav-list-link active">Agent Implementation</a></li><li class="nav-list-item"><a href="/articles/messaging" class="nav-list-link">Messaging</a></li><li class="nav-list-item"><a href="/articles/using_amqpspace" class="nav-list-link">Using AMQPSpace</a></li></ul> <ul class="nav-list nav-category-list"> <li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="Toggle collection API Documentation" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><div class="nav-category">API Documentation</div> <ul class="nav-list"><li class="nav-list-item"><a href="/api_docs/agency.html" class="nav-list-link">agency</a></li><li class="nav-list-item"><a href="/api_docs/agency/agent.html" class="nav-list-link">agency.agent</a></li><li class="nav-list-item"><a href="/api_docs/agency/processor.html" class="nav-list-link">agency.processor</a></li><li class="nav-list-item"><a href="/api_docs/agency/processors.html" class="nav-list-link">agency.processors</a></li><li class="nav-list-item"><a href="/api_docs/agency/processors/native_thread_processor.html" class="nav-list-link">agency.processors.native_thread_processor</a></li><li class="nav-list-item"><a href="/api_docs/agency/schema.html" class="nav-list-link">agency.schema</a></li><li class="nav-list-item"><a href="/api_docs/agency/space.html" class="nav-list-link">agency.space</a></li><li class="nav-list-item"><a href="/api_docs/agency/spaces.html" class="nav-list-link">agency.spaces</a></li><li class="nav-list-item"><a href="/api_docs/agency/spaces/amqp_space.html" class="nav-list-link">agency.spaces.amqp_space</a></li><li class="nav-list-item"><a href="/api_docs/agency/spaces/native_space.html" class="nav-list-link">agency.spaces.native_space</a></li><li class="nav-list-item"><a href="/api_docs/agency/util.html" class="nav-list-link">agency.util</a></li></ul> </li> </ul> </nav> &nbsp </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="" aria-label="" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/operand/agency" class="site-button" target="_blank" rel="noopener noreferrer" > Agency on Github️ </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="agent-implementation"> <a href="#agent-implementation" class="anchor-heading" aria-labelledby="agent-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Agent Implementation </h1> <p>To create an agent, extend the <code class="language-plaintext highlighter-rouge">Agent</code> class.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MyAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="p">...</span>
</code></pre></div></div> <h2 id="defining-actions"> <a href="#defining-actions" class="anchor-heading" aria-labelledby="defining-actions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining Actions </h2> <p>Actions are simply instance methods decorated with <code class="language-plaintext highlighter-rouge">@action</code>. The <code class="language-plaintext highlighter-rouge">@action</code> decorator takes the following keyword arguments:</p> <ul> <li><code class="language-plaintext highlighter-rouge">name</code>: The name of the action. Defaults to the method name</li> <li><code class="language-plaintext highlighter-rouge">help</code>: The description of the action. Defaults to autogenerated object</li> <li><code class="language-plaintext highlighter-rouge">access_policy</code>: The access policy of the action. Defaults to <code class="language-plaintext highlighter-rouge">ACCESS_PERMITTED</code></li> </ul> <h2 id="defining-help"> <a href="#defining-help" class="anchor-heading" aria-labelledby="defining-help"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining Help </h2> <p>The <code class="language-plaintext highlighter-rouge">help</code> attribute may be used for describing the given action to other agents.</p> <p>Below is an example of the help information generated by default from the <code class="language-plaintext highlighter-rouge">@action</code> decorator arguments and the method’s signature.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s">"shell_command"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">"description"</span><span class="p">:</span> <span class="s">"Execute a shell command"</span><span class="p">,</span>
    <span class="s">"args"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"command"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"type"</span><span class="p">:</span> <span class="s">"string"</span>
        <span class="s">"description"</span><span class="p">:</span> <span class="s">"The command to execute"</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">"returns"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"type"</span><span class="p">:</span> <span class="s">"string"</span>
      <span class="s">"description"</span><span class="p">:</span> <span class="s">"The output of the command"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>The following example shows how the same help information above can be defined using a docstring that follows the <a href="https://github.com/google/styleguide/blob/gh-pages/pyguide.md#383-functions-and-methods">Google style guide</a>:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">action</span>
<span class="k">def</span> <span class="nf">shell_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="s">"""
    Execute a shell command

    Args:
        command (str): The command to execute

    Returns:
        str: The output of the command
    """</span>
</code></pre></div></div> <p>The action name is determined by the method name.</p> <p>Types are determined by looking at the docstring and the signature, with the signature type hint taking precedence.</p> <p>Action and argument descriptions are parsed from the docstring.</p> <h3 id="overriding-help-information"> <a href="#overriding-help-information" class="anchor-heading" aria-labelledby="overriding-help-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overriding Help Information </h3> <p>The default help data structure could be customized as well:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">action</span><span class="p">(</span>
    <span class="n">help</span><span class="o">=</span><span class="p">{</span>
      <span class="s">"You"</span><span class="p">:</span> <span class="s">"can define"</span><span class="p">,</span>
      <span class="s">"any"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"structure"</span><span class="p">:</span> <span class="p">[</span><span class="s">"you"</span><span class="p">,</span> <span class="s">"want"</span><span class="p">,</span> <span class="s">"here."</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
</code></pre></div></div> <p>If a <code class="language-plaintext highlighter-rouge">help</code> object is provided to the decorator, it overrides the generated object entirely. You can use this to experiment with different help information schemas.</p> <p>Merging the two objects, for example to only override specific fields, is not (yet) supported. Please open an issue if you’d like to see this feature developed.</p> <h2 id="special-actions"> <a href="#special-actions" class="anchor-heading" aria-labelledby="special-actions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Special Actions </h2> <p>There are three special actions present on all agents by default:</p> <p>Override or extend these actions to customize the behavior of your agent.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">help</code><br /> Returns a list of all actions on this agent. This is used by agents for action discovery. You normally do not need to implement this method but you may do so for example, to control which actions are returned to other agents.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">response</code><br /> If an action method returns a value, this method will be called with the value.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">error</code><br /> Receives any error messages from an action invoked by the agent.</p> </li> </ul> <h2 id="callbacks"> <a href="#callbacks" class="anchor-heading" aria-labelledby="callbacks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Callbacks </h2> <p>The following is the list of agent callbacks you may implement.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">before_action</code><br /> Called before an action is attempted. If an exception is raised in <code class="language-plaintext highlighter-rouge">before_action</code>, the action method and <code class="language-plaintext highlighter-rouge">after_action</code> callbacks will not be executed and the error will be returned to the sender.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">after_action</code><br /> Called after an action is attempted. Provides the original message, the return value, and error if applicable. This method is called even if an exception is raised in the action.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">after_add</code><br /> Called after an agent is added to a space and may begin sending/receiving messages. Use this method to perform any initial setup necessary upon being added to a space.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">before_remove</code><br /> Called before an agent is removed from a space and will no longer send/receive messages. Use this method to perform any cleanup necessary before being removed from a space.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">request_permission</code><br /> Called when an agent attempts to perform an action that requires permission. This method should return <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code> to indicate whether the action should be allowed. A rejected action will be returned as a permission error to the sender.</p> </li> </ul> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
